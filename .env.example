# TiebaScraper 环境变量配置示例
# 将此文件复制为 .env 并根据需要修改变量值
# 环境变量优先级高于 config.toml 配置文件
# 使用双下划线 __ 分隔配置层级，不区分大小写

# ==============================================================================
# 数据库配置 (PostgreSQL)
# ==============================================================================
# 数据库主机地址
DATABASE__HOST=localhost
# 数据库端口
DATABASE__PORT=5432
# 数据库用户名
DATABASE__USERNAME=admin
# 数据库密码
DATABASE__PASSWORD=123456
# 数据库名称
DATABASE__DB_NAME=tieba_data
# 是否启用 PostgreSQL 分区（TimescaleDB），true/false
DATABASE__PARTITION_ENABLED=false
# 分区间隔（如果启用了分区）
DATABASE__P_INTERVAL="1 month"

# ==============================================================================
# Redis 配置
# ==============================================================================
# Redis 主机地址
REDIS__HOST=localhost
# Redis 端口
REDIS__PORT=6379
# Redis 用户名（可留空）
REDIS__USERNAME=
# Redis 密码（可留空）
REDIS__PASSWORD=
# Redis 数据库编号
REDIS__DB=0

# ==============================================================================
# 贴吧监控配置
# ==============================================================================
# 要监控的贴吧列表 (JSON 数组格式)
# 示例: ["forum_a", "forum_b"]
TIEBA__FORUMS=["forum_a", "forum_b"]

# 贴吧分组配置 (JSON 对象数组格式)
# 可为不同分组设置独立的调度周期
# 示例: [{"name": "high_freq", "forums": ["hot_bar"], "interval_seconds": 30}]
TIEBA__GROUPS=[]

# 历史回溯模式最大页数
TIEBA__MAX_BACKFILL_PAGES=100

# ==============================================================================
# 爬虫限流配置
# ==============================================================================
# 每秒请求数限制 (RPS)
RATE_LIMIT__RPS=10
# 并发数限制
RATE_LIMIT__CONCURRENCY=8
# 遇 HTTP 429 后的全局冷却时间（秒）
RATE_LIMIT__COOLDOWN_SECONDS_429=5.0

# ==============================================================================
# 缓存配置
# ==============================================================================
# 缓存后端: "memory" 或 "redis"
CACHE__BACKEND=memory
# 内存缓存最大条目数 (仅 memory 模式有效)
CACHE__MAX_SIZE=100000
# 缓存过期时间 (秒)
CACHE__TTL_SECONDS=86400

# ==============================================================================
# 调度器配置
# ==============================================================================
# 全局调度扫描周期 (秒)
# 适用于未分组的贴吧
SCHEDULER__INTERVAL_SECONDS=60
# 每 N 个周期扫描一次精华贴首页
SCHEDULER__GOOD_PAGE_EVERY_N_TICKS=10

# ==============================================================================
# WebSocket 服务配置
# ==============================================================================
# 是否启用 WebSocket 服务: true/false
WEBSOCKET__ENABLED=true
# WebSocket 监听主机
WEBSOCKET__HOST=localhost
# WebSocket 监听端口
WEBSOCKET__PORT=8000
# WebSocket 路径
WEBSOCKET__PATH=/ws
# 访问令牌 (留空则不校验)
WEBSOCKET__TOKEN=

# ==============================================================================
# 消费者推送配置
# ==============================================================================
# 推送方式: "redis", "websocket" 或 "none"
CONSUMER__TRANSPORT=websocket
# 推送模式: "id" (仅ID), "object" (完整对象)
CONSUMER__MODE=id
# 队列最大长度
CONSUMER__MAX_LEN=10000
# ID 模式队列的 Redis 键
CONSUMER__ID_QUEUE_KEY=scraper:tieba:queue
# Object 模式 Redis stream 的前缀
CONSUMER__STREAM_PREFIX=scraper:tieba:events
# 推送超时时间 (毫秒)
CONSUMER__TIMEOUT_MS=2000
# 最大重试次数
CONSUMER__MAX_RETRIES=5
# 重试避退间隔 (毫秒)
CONSUMER__RETRY_BACKOFF_MS=200
